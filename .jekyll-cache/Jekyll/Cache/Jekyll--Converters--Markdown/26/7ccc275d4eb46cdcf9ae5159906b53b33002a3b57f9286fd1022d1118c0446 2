I"ï<p>If you are reading an article about vintage motorcycles, you are likely more interested in seeing ads for the latest
Triumph Thruxton cafe racer than about woodworking supplies. For this reason, content publishers are
interested in classifying content into some shared high-level categories. The Interactive Advertising Bureau
(<a href="https://www.iab.com/">IAB</a>) publishes a common set of <a href="https://www.iab.com/guidelines/content-taxonomy/">categories</a> that is
used for this purpose. The categories are hierarchical and contain about 600 categories at the lowest level.
In this post, we look at how you can use Machine Learning (ML) to automatically categorize text and image data into IAB
categories without any labeled data or ML expertise.</p>

<h2 id="the-challenge">The Challenge</h2>

<p>Manually categorizing online content is expensive and doesn‚Äôt scale, leading folks to look for automated solutions that
use ML. When they do, they usually face a couple of challenges:</p>

<ul>
  <li>Given the large number of categories, it‚Äôs laborious to create labeled data for training a ML model</li>
  <li>Most ML systems and services require days or weeks of learning and setup time for non-experts</li>
</ul>

<h2 id="the-solution">The Solution</h2>

<p>We are going to use Nyckel‚Äôs <a href="../blog/a-quick-look-at-text-search-functions/">text search</a> functionality to classify image and text data into IAB categories in just minutes. Text search works in the following way:</p>

<ul>
  <li>You upload a set of test samples that form your ‚Äúsearch set‚Äù. In this case, we will use IAB categories as the search
set.</li>
  <li>You query the search set with text or image data - referred to as ‚Äúquery data‚Äù. Nyckel finds the closest semantic
matches to your query data among your search set.</li>
</ul>

<h2 id="demo">Demo</h2>

<p>The clickable demo below shows how fast this is to set up using Nyckel without any ML or cloud infrastructure expertise.</p>

<figure class="figure" style="width: 100%">
    <div style="position: relative; padding-bottom: calc(67.56756756756756% + 41px); height: 0;">
        <iframe src="https://demo.arcade.software/oFZ1Oq3hJbEjj1sqPzX9?embed" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 5px;"></iframe>
    </div>
    
    <figcaption>Create an IAB classification function</figcaption>
    
</figure>

<p>Some things to keep in mind:</p>

<ul>
  <li>The IAB taxonomy is a hierarchy of categories. This demo uses categories from the lowest level, with each level in the hierarchy combined in the form ‚ÄúLevel 1, Level 2, Level 3‚Äù. Depending on your use-case, you may only want to categorize at a higher
level of the hierarchy.</li>
  <li>Deep neural networks that process natural language usually have a limit of how long the text can be. We recommend you
keep your query text to about 128 words. If your document is larger than that we suggest categorizing it in chunks
and aggregating the resulting categories, or just categorizing the introductory paragraph, which usually provides an
meaningful overview of the content.</li>
</ul>

<h2 id="how-it-works">How it Works</h2>

<p>To delve a bit into the technical details, Nyckel uses deep neural networks to extract an ‚Äúembedding‚Äù for
the search set and query data. These embeddings are high-dimensional vectors of floating point numbers that capture a
semantic understanding of the data. This means that two semantically similar pieces of data will produce embedding
vectors that are close to each other in the high-dimensional vector space. When querying the search set, we find the
embedding vectors in the search set that are closest to the embedding vector for the query data. Peter Gao, the CEO of
<a href="https://www.aquariumlearning.com/">Aquarium Learning</a>, has an <a href="https://medium.com/aquarium-learning/the-unreasonable-effectiveness-of-neural-network-embeddings-93891acad097">excellent blog post</a> about embeddings if you‚Äôd like to learn more.</p>

<h2 id="try-it-out">Try it out</h2>

<p>You can create a <a href="https://www.nyckel.com/console">free Nyckel account</a> and use <a href="../data/IABTaxonomy.tsv">this text file</a> of IAB
categories to create your own IAB classification function as shown in the demo above. The API tab on your function
will show you how invoke your function using an API, but here is one example of getting the top 2 matching categories
for an image:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-X</span> POST <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'Authorization: Bearer &lt;authToken&gt;'</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"data":"http://url-for-image"}'</span> <span class="se">\</span>
  https://www.nyckel.com/v0.9/functions/&lt;functionId&gt;/search?sampleCount<span class="o">=</span>2&amp;includeData<span class="o">=</span><span class="nb">true</span>
</code></pre></div></div>
:ET